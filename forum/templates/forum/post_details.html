{%  extends 'forum/index.html' %}
{% load static %}

{% block leftAside %}
{% endblock %}

{% block articles %}
    {% if post %}
        <div class="postSection">
            <div class="postArticle">
                <div class="toppost">
                    <a href=""><img src="{{ post.owner.profile.profile_image }}" alt="Avatar" class="avatar"></a>
                    <a href="">{{ post.owner.username}}</a>
                    <a>{{ post.pub_date }}</a>
                </div>
                <div class="textpost">
                    <p class="postTitle">{{ post.title }}</p>
                    <p class="postText">{{ post.text }}</p>
                </div>
                <div class="buttonspost">
                    {% if user.is_authenticated %}
                        <form class="likeForm" method="post" action="{% url 'forum:api_like_toggle' %}">
                            {% csrf_token %}
                            <input type="hidden" name="post_id" value="{{ post.id }}">
                            <input type="submit" class="like {% if user in post.post_pizzas.all %}liked{% endif %}"  value="">
                        </form>
                    {% endif %}
                    <p name="{{ post.id }}" class="numberPizzas">{{ post.num_likes }} Like{{ post.num_likes|pluralize }}</p>
                    <button id="commentButton">Comment</button>
                </div>
                <form class="commentBar" method="post" action="">
                    <input type="text" name="comment" placeholder="Add a comment" id="commentInput">
                </form>
                {% if post.comment_set.all %}
                    {% for comment in post.comment_set.all %}
                        <div class="commentsArticle">
                            <div class="commentsTop">
                                <a href=""><img src="{{ comment.owner.profile.profile_image }}" alt="Avatar" class="avatar"></a>
                                <a href="">{{ comment.owner.username}}</a>
                                <a>{{ post.pub_date }}</a>
                            </div>
                            <div class="commentsText">
                                <a>{{ comment.text }}</a>
                            </div>
                            <div class="commentsButtons">
                                {% if user.is_authenticated %}
                                    <form class="likeForm" method="post" action="{% url 'forum:api_like_toggle' %}">
                                        {% csrf_token %}
                                        <input type="hidden" name="post_id" value="{{ post.id }}">
                                        <input type="submit" class="like commentsLike {% if user in comment.post_pizzas.all %} liked commentsLiked {% endif %}"  value="">
                                    </form>
                                {% endif %}
                                <p name="{{ post.id }}" class="numberPizzas commentsPizzas">{{ comment.num_likes }} Like{{ comment.num_likes|pluralize }}</p>
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                {% endif %}
            </div>
        </div>
    {% else %}
        Não há esse post :/
    {% endif %}
{% endblock articles %}